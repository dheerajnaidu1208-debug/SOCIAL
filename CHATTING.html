<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DAITANO Social</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,Arial}
body{background:#000;color:#fff;height:100vh;width:100vw;overflow:hidden}

/* Auth */
.auth{display:flex;justify-content:center;align-items:center;height:100vh;width:100vw}
.auth-box{background:#111;padding:22px;border-radius:12px;width:320px;border:1px solid #222;box-shadow:0 0 18px rgba(0,149,246,0.6)}
.auth-box h2{text-align:center;color:#0095f6;margin-bottom:14px}
.auth-box input{width:100%;padding:11px;margin:8px 0;border:none;border-radius:8px;background:#222;color:#fff}
.auth-box button{width:100%;padding:11px;border:none;border-radius:8px;background:#0095f6;color:#fff;font-weight:600;cursor:pointer}
.toggle{text-align:center;color:#aaa;margin-top:10px;cursor:pointer;font-size:13px}

/* Pages */
.page{display:none;width:100vw;height:100vh;flex-direction:column}
header{background:#111;padding:14px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #333}
header h3{color:#0095f6;font-size:18px}
header button{background:#0095f6;border:none;padding:6px 12px;border-radius:6px;color:#fff;cursor:pointer}

/* Inbox */
#friends{flex:1;overflow-y:auto;padding:15px}
.friend{background:#222;padding:10px;margin:8px 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center;font-size:14px}

/* Notifications */
#reqs{flex:1;overflow-y:auto;padding:15px}
.req{background:#222;padding:10px;margin:8px 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center;font-size:14px}

/* Chat */
#chatBox{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;background:#000}
.msg{padding:8px 12px;border-radius:16px;font-size:13px;max-width:72%;margin:6px 0}
.me{background:#0095f6;align-self:flex-end;border-bottom-right-radius:5px}
.you{background:#333;align-self:flex-start;border-bottom-left-radius:5px}
.chat-input{display:flex;padding:10px;background:#111;border-top:1px solid #333}
.chat-input input{flex:1;padding:9px;border:none;border-radius:20px;background:#222;color:#fff;margin-right:6px}
.chat-input button{background:#0095f6;border:none;padding:0 14px;border-radius:20px;color:white;cursor:pointer;font-size:13px}
</style>
</head>
<body>

<!-- AUTH -->
<div class="auth" id="authUI">
  <div class="auth-box" id="signupUI">
    <h2>Sign Up</h2>
    <input id="suU" placeholder="Username">
    <input id="suP" placeholder="Password" type="password">
    <button onclick="signup()">Create Account</button>
    <div class="toggle" onclick="swap()">Have account? Sign In</div>
  </div>

  <div class="auth-box" id="loginUI" style="display:none">
    <h2>Sign In</h2>
    <input id="lgU" placeholder="Username">
    <input id="lgP" placeholder="Password" type="password">
    <button onclick="login()">Login</button>
    <div class="toggle" onclick="swap()">No account? Sign Up</div>
  </div>
</div>

<!-- INBOX -->
<div class="page" id="inbox">
<header>
  <h3>Inbox</h3>
  <div>
    <button onclick="go('notify')">Requests</button>
    <button onclick="logout()">Logout</button>
  </div>
</header>
<div id="friends"></div>
</div>

<!-- NOTIFICATIONS -->
<div class="page" id="notify">
<header>
  <h3>Friend Requests</h3>
  <button onclick="go('inbox')">Back</button>
</header>
<div id="reqs"></div>
</div>

<!-- CHAT -->
<div class="page" id="chat">
<header>
  <h3 id="chatWith">Chat</h3>
  <button onclick="go('inbox')">Close</button>
</header>
<div id="chatBox"></div>
<div class="chat-input">
  <input id="msgIn" placeholder="Message...">
  <button onclick="send()">Send</button>
</div>
</div>

<script>
let currentUser = localStorage.getItem("currentUser");
let users = JSON.parse(localStorage.getItem("users")||"{}");
let requests = JSON.parse(localStorage.getItem("requests")||"{}");
let chats = JSON.parse(localStorage.getItem("chats")||"{}");

// Swap auth UI
function swap(){
  signupUI.style.display = signupUI.style.display==="none" ? "block" : "none";
  loginUI.style.display = loginUI.style.display==="none" ? "block" : "none";
}

// Signup
function signup(){
  let u=suU.value.trim(), p=suP.value.trim();
  if(!u||!p){alert("Fill all!");return}
  if(users[u]){alert("User exists!");return}
  users[u]=p;
  localStorage.setItem("users",JSON.stringify(users));
  alert("Account Created! Now Login.");
  swap();
}

// Login
function login(){
  let u=lgU.value.trim(), p=lgP.value.trim();
  if(users[u]===p){
    localStorage.setItem("currentUser",u);
    location.reload();
  } else alert("Invalid login!");
}

// Logout
function logout(){localStorage.removeItem("currentUser");location.reload()}

// Navigation
function go(pg){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
  document.getElementById(pg).style.display="flex";
  if(pg==="chat") loadChat();
}

// Send request
function addFriend(u){
  if(!requests[u]) requests[u]=[];
  if(requests[u].includes(currentUser)){alert("Already sent");return}
  requests[u].push(currentUser);
  localStorage.setItem("requests",JSON.stringify(requests));
  alert("Request sent!");
}

// Accept request
function accept(i){
  let list = requests[currentUser];
  let u = list[i];
  chats[currentUser]=chats[currentUser]||{};
  chats[u]=chats[u]||{};
  chats[currentUser][u]=[];
  chats[u][currentUser]=[];
  list.splice(i,1);
  localStorage.setItem("requests",JSON.stringify(requests));
  localStorage.setItem("chats",JSON.stringify(chats));
  render();
}

// Open chat
function openChat(u){
  localStorage.setItem("chatUser",u);
  go("chat");
  chatWith.innerText=u;
}

// Load chat
function loadChat(){
  let u = localStorage.getItem("chatUser");
  if(!u) return;
  chats[currentUser]=chats[currentUser]||{};
  chats[currentUser][u]=chats[currentUser][u]||[];
  chats[u]=chats[u]||{};
  chats[u][currentUser]=chats[u][currentUser]||[];

  chatBox.innerHTML = chats[currentUser][u].map(m=>`<div class='msg ${m.me?"me":"you"}'>${m.text}</div>`).join("");
}

// Send msg
function send(){
  let u=localStorage.getItem("chatUser");
  let t=msgIn.value.trim();
  if(!t)return;
  chats[currentUser][u].push({text:t,me:true});
  chats[u][currentUser].push({text:t,me:false});
  localStorage.setItem("chats",JSON.stringify(chats));
  msgIn.value="";
  loadChat();
}

// Render UI
function render(){
  if(!currentUser){authUI.style.display="flex";return}
  authUI.style.display="none";
  go("inbox");

  friends.innerHTML = Object.keys(users).filter(u=>u!==currentUser).map(u=>
    `<div class='friend'><span>${u}</span><button onclick="addFriend('${u}')">Add Friend</button><button onclick="openChat('${u}')">Chat</button></div>`
  ).join("");

  reqs.innerHTML = (requests[currentUser]||[]).map((u,i)=>
    `<div class='req'><span>${u}</span><button onclick="accept(${i})">Accept</button></div>`
  ).join("");
}

render();
</script>
</body>
</html>
